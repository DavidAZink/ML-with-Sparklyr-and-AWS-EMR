# ML-with-Sparklyr-and-AWS-EMR
I tune and train an ML model using Sparklyr (R interface for Spark) on an AWS EMR cluster
The ML model predicts high risk mortgages using data from the Home Mortgage Disclosure Act, US Census Bureau, BLS, and Zillow. The dataset consists of roughly 7 million observations and 76 features. HMDA data identifies high risk borrowers for years 2018 and 2019. For my research I would like to identify high risk borrowers in HMDA data for years prior to 2018. Therefore, I train an elasticnet logistic regression model that can be used to predict high risk borrowers in all years prior to 2018. I did this by launching a cluster on AWS EMR and connecting with R Studio Server. I then used the Sparklyr package (R interface for Spark) to set up an ML pipeline that uses cross validation to select optimal hyperparamters for an elastic-net regularized regression. I then refit the model on the entire training dataset and evaluated performance on the test data. The data is highly imbalanced (3% of borrowers are high risk), therefore I weight the loss function with inverse class probabilities and use the AUROC as the metric to evaluate model performance (This metric is more robust to class imbalance). The optimal model achieves an AUROC of 73% on the test data. 
If you would like to run this program yourself you will need access to the data, which I temporarily stored on AWS S3 in order to complete this project. Please contact me and I can provide this to you. The data is too large for me to store on GitHub. 
